# pages/09_09_employment_rate.py
"""
ì²­ë…„ ê³ ìš© ë™í–¥ ë¶„ì„ â€“ SDGâ€¯8 (ì–‘ì§ˆì˜ ì¼ìë¦¬ì™€ ê²½ì œ ì„±ì¥)
ì´ í˜ì´ì§€ëŠ” employmentrate.csv íŒŒì¼(2010â€‘2024)ì„ í™œìš©í•´ ìš°ë¦¬ë‚˜ë¼ ì²­ë…„ ê³ ìš© ì§€í‘œë¥¼ ì‹œê°í™”í•˜ê³ ,
í•™ìƒ í† ë¡ â€§êµìœ¡ì  í•¨ì˜â€§í™•ì¥ í™œë™ì„ ì œì‹œí•©ë‹ˆë‹¤.
"""

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë¼ì´ë¸ŒëŸ¬ë¦¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
import os

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ í˜ì´ì§€ ì„¤ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.set_page_config(page_title="ğŸ‡°ğŸ‡· ì²­ë…„ ê³ ìš© ë™í–¥ ë¶„ì„", layout="wide")
st.title("ğŸ‘©â€ğŸ’¼ ìš°ë¦¬ë‚˜ë¼ ì²­ë…„ ê³ ìš© ë™í–¥ ë¶„ì„ (SDGâ€¯8)")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def read_csv(name: str) -> pd.DataFrame:
    path = os.path.join(os.path.dirname(__file__), "..", name)
    if os.path.exists(path):
        return pd.read_csv(path, encoding="utf-8-sig")
    upl = st.file_uploader(f"â¬†ï¸ {name} ì—…ë¡œë“œ", type="csv", key=name)
    if upl is not None:
        return pd.read_csv(upl)
    st.stop()

raw = read_csv("employmentrate.csv")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë°ì´í„° ì „ì²˜ë¦¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
raw = raw.set_index("Unnamed: 0").T
raw.index.name = "ì—°ë„"
raw = raw.applymap(lambda x: float(str(x).replace(",", "")))
raw["ê³ ìš©ë¥ (%)"] = raw["ì·¨ì—…ì"] / raw["ê²½ì œí™œë™ì¸êµ¬"] * 100
raw["ì°¸ì—¬ìœ¨(%)"] = raw["ê²½ì œí™œë™ì¸êµ¬"] / raw["ìƒì‚°ê°€ëŠ¥ì¸êµ¬"] * 100
raw = raw.reset_index()
raw["ì—°ë„"] = raw["ì—°ë„"].astype(int)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì£¼ìš” ì§€í‘œ ì‹œê°í™” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("### ğŸ“ˆ ì£¼ìš” ì§€í‘œ ê°œë³„ ì¶”ì´ ì‹œê°í™”")
metric_cols = ["ê²½ì œí™œë™ì¸êµ¬", "ì·¨ì—…ì", "ì‹¤ì—…ë¥ ", "ê³ ìš©ë¥ (%)", "ì°¸ì—¬ìœ¨(%)"]
sel_metric = st.selectbox("ğŸ“Š ë¶„ì„í•  ì§€í‘œ ì„ íƒ", metric_cols, index=2)

fig_line = px.line(raw, x="ì—°ë„", y=sel_metric, markers=True,
                   title=f"'{sel_metric}' ì—°ë„ë³„ ë³€í™” ì¶”ì´",
                   labels={"ì—°ë„": "ì—°ë„", sel_metric: sel_metric})
fig_line.update_traces(line=dict(width=3), marker=dict(size=8))
fig_line.update_layout(title_font_size=18)
st.plotly_chart(fig_line, use_container_width=True)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì§€í‘œ ê°„ ê´€ê³„ ì‹œê°í™” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("### ğŸ”„ ê³ ìš©ë¥ ê³¼ ì‹¤ì—…ë¥  ê´€ê³„ ë³´ê¸°")
scatter = go.Figure()
scatter.add_trace(go.Scatter(x=raw["ê³ ìš©ë¥ (%)"], y=raw["ì‹¤ì—…ë¥ "],
                             mode="markers+text",
                             text=raw["ì—°ë„"],
                             textposition="top center",
                             marker=dict(size=12, color="orange")))
scatter.update_layout(title="ê³ ìš©ë¥ ê³¼ ì‹¤ì—…ë¥ ì˜ ê´€ê³„ (ì—°ë„ë³„)",
                      xaxis_title="ê³ ìš©ë¥ (%)",
                      yaxis_title="ì‹¤ì—…ë¥ (%)",
                      height=500)
st.plotly_chart(scatter, use_container_width=True)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ íŠ¹ì • ì—°ë„ ì§€í‘œ ë¹„êµ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("### ğŸ§­ íŠ¹ì • ì—°ë„ë³„ ì§€í‘œ ìš”ì•½")
sel_year = st.slider("ì—°ë„ ì„ íƒ", int(raw["ì—°ë„"].min()), int(raw["ì—°ë„"].max()), int(raw["ì—°ë„"].max()))
year_df = raw[raw["ì—°ë„"] == sel_year].drop(columns="ì—°ë„").T.reset_index()
year_df.columns = ["ì§€í‘œ", "ê°’"]
bar_fig = px.bar(year_df, x="ì§€í‘œ", y="ê°’", text="ê°’",
                 title=f"{sel_year}ë…„ ì²­ë…„ ê³ ìš© ì§€í‘œ í˜„í™©")
bar_fig.update_traces(texttemplate='%{text:.1f}', textposition='outside')
bar_fig.update_layout(yaxis_range=[0, year_df["ê°’"].max() * 1.15])
st.plotly_chart(bar_fig, use_container_width=True)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
with st.expander("ğŸ” ì›ë³¸ ë°ì´í„° ë³´ê¸°"):
    st.dataframe(raw)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ SDG ì—°ê³„ ë° ìˆ˜ì—… ìš”ì†Œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("### ğŸ’¬ í•™ìƒ í† ë¡  ì§ˆë¬¸")
st.markdown("""
1. **ì‹¤ì—…ë¥ ì´ ê°€ì¥ ë†’ì•˜ë˜ í•´**ëŠ” ì–¸ì œì´ë©°, ê·¸ í•´ì˜ ì‚¬íšŒÂ·ê²½ì œì  ìš”ì¸ì€ ë¬´ì—‡ì´ì—ˆë‚˜ìš”?  
2. **ê³ ìš©ë¥ ê³¼ ì‹¤ì—…ë¥ **ì´ í•­ìƒ ë°˜ë¹„ë¡€í•˜ì§€ ì•ŠëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?  
3. **ì½”ë¡œë‚˜19**(2020ë…„ê²½)ê°€ ì²­ë…„ ê³ ìš©ì— ë¯¸ì¹œ ì˜í–¥ì€ ì–´ë–»ê²Œ ë‚˜íƒ€ë‚¬ë‚˜ìš”?  
4. SDGs **ëª©í‘œâ€¯8** ê´€ì ì—ì„œ _"ì–‘ì§ˆì˜ ì¼ìë¦¬"_ ëŠ” ë¬´ì—‡ì„ ì˜ë¯¸í•˜ë©°, ì²­ë…„ì¸µì—ê²Œ ì™œ ì¤‘ìš”í• ê¹Œìš”?
""")

st.markdown("### ğŸ“š êµìœ¡ì  í•¨ì˜")
st.markdown("""
- **ìë£Œ í•´ì„ë ¥ í–¥ìƒ**: êµ­ê°€ í†µê³„ ì‹œê³„ì—´ í•´ì„ì„ í†µí•´ ìˆ˜ë¦¬ì Â·ë¹„íŒì  ì‚¬ê³ ë ¥ ê°•í™”  
- **ì‚¬íšŒÂ·ê²½ì œ êµ¬ì¡° ì´í•´**: ì²­ë…„ ê³ ìš© ë³€í™”ì™€ ì •ì±…ì˜ ìƒê´€ê´€ê³„ë¥¼ íƒêµ¬  
- **ì§€ì†ê°€ëŠ¥ë°œì „ ëª©í‘œ ì ‘ëª©**: ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ _í¬ìš©ì Â·ì§€ì†ê°€ëŠ¥í•œ ì„±ì¥_ ì˜ í•„ìš”ì„± ê³ ì°°
""")

st.markdown("### ğŸš€ í™•ì¥ í™œë™")
st.markdown("""
- **ì§€ì—­Â·ì„±ë³„ ë°ì´í„° ì¶”ê°€ ë¶„ì„**ìœ¼ë¡œ ê³ ìš© ê²©ì°¨ íƒìƒ‰  
- ê³¼ê±° ì¶”ì„¸ë¥¼ í™œìš©í•œ **ë¯¸ë˜ ê³ ìš©ë¥  ì˜ˆì¸¡ ëª¨ë¸**(ì„ í˜• íšŒê·€ ë“±) ì‹¤ìŠµ  
- **ì²­ë…„ ì¸í„°ë·°/ì„¤ë¬¸ í”„ë¡œì íŠ¸**: í†µê³„ ìˆ˜ì¹˜ì™€ ì‹¤ì œ ê²½í—˜ ë¹„êµ  
- **ì •ì±… ì œì•ˆì„œ ì‘ì„±**: ë°ì´í„° ê·¼ê±°ë¡œ ì²­ë…„ ê³ ìš© ê°œì„  ë°©ì•ˆ ì œì‹œ
""")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ í‘¸í„° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.info("ë°ì´í„° ì¶œì²˜: í†µê³„ì²­ ì²­ë…„ ê³ ìš© ë™í–¥(2010â€“2024) | Â©â€¯2025, êµìœ¡ìš© ì˜ˆì‹œ ìŠ¤í¬ë¦½íŠ¸")
